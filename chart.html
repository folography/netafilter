<!doctype html>
<html class="no-js" lang="">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>MyNeta</title>
  <meta name="description" content="">
  <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />

  <link href="https://www.mapbox.com/base/latest/base.css" rel="stylesheet">
  <link rel="stylesheet" href="css/main.css">
  <script src="js/vendor/modernizr-2.8.3.min.js"></script>
  <script src="//d3js.org/d3.v3.min.js" charset="utf-8"></script>
  <script src="js/vendor/nv.d3.min.js" charset="utf-8"></script>
  <link rel="stylesheet" href="js/vendor/nv.d3.css">
  <style>

  </style>
</head>

<body>
  <!--[if lt IE 8]>
            <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->
  <!-- Content -->

  <h1>Neta ji, how do you do?</h1>
  <div id='chart'>
    <svg style="width:800px;  height:500px">
    </svg>
  </div>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
  <script>
    // Load data
    d3.csv("data/myneta-loksabha.csv", function(data) {

      var scatterData = d3.nest()
        .key(function(d) {
          return d['ST_NAME'];
        })
        .entries(data);


      // Parse strings to integers http://learnjsdata.com/read_data.html
      data.forEach(function(d, i) {

        d['myneta Education Points'] = +d['myneta Education Points']
        d['myneta Total Assets'] = +d['myneta Total Assets'] / 10000000
        d['myneta Criminal Case'] = +d['myneta Criminal Case']

      });

      // DEBUG
      window.data = scatterData;
      console.log(window.data);

    });

    // Create scatterChart
    // http://nvd3.org/examples/scatter.html
    nv.addGraph(function() {
      var chart = nv.models.scatterChart()
        .showDistX(true)
        .showDistY(true)
        .duration(100)
        .x(function(d) {
          return d['myneta Education Points'];
        })
        .y(function(d) {
          return d['myneta Total Assets'];
        })
        .pointSize(function(d) {
          return d['myneta Criminal Case'];
        })
        // .color(d3.scale.category20().range());
        .color(d3.scale.category20().range())
        .pointScale(d3.scale.linear().range(100));

      chart.tooltip.contentGenerator(function(obj) {
        console.log(obj);
        return '<h3>' + obj.point['myneta Candidate'] + '</h3><br><h4>' + obj.point['PC_NAME2'] + ', ' + obj.point['ST_NAME'] + '</h4>'
      }).headerEnabled(true)

      //Axis settings
      chart.xAxis.tickFormat(d3.format('.02f'));
      chart.yAxis.tickFormat(d3.format('.02f'));


      d3.select('#chart svg')
        // .datum(myData)
        .datum(window.data)
        .call(chart);


      nv.utils.windowResize(chart.update);

      return chart;
    });


  </script>
</body>

</html>
